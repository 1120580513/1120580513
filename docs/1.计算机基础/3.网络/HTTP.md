# HTTP

## ä¸‰æ¬¡æ¡æ‰‹

1. å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªå¸¦ SYN æ ‡å¿—çš„ TCP æŠ¥æ–‡åˆ°æœåŠ¡å™¨ã€‚è¿™æ˜¯ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­çš„æŠ¥æ–‡ 1ã€‚
2. æœåŠ¡å™¨ç«¯å›åº”å®¢æˆ·ç«¯çš„ï¼Œè¿™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ä¸­çš„ç¬¬ 2 ä¸ªæŠ¥æ–‡ï¼Œè¿™ä¸ªæŠ¥æ–‡åŒæ—¶å¸¦ ACK æ ‡å¿—å’Œ SYN æ ‡å¿—ã€‚å› æ­¤å®ƒè¡¨ç¤ºå¯¹åˆšæ‰å®¢æˆ·ç«¯ SYN æŠ¥æ–‡çš„å›åº”ï¼›åŒæ—¶åˆæ ‡å¿— SYN ç»™å®¢æˆ·ç«¯ï¼Œè¯¢é—®å®¢æˆ·ç«¯æ˜¯å¦å‡†å¤‡å¥½è¿›è¡Œæ•°æ®é€šè®¯ã€‚
3. å®¢æˆ·å¿…é¡»å†æ¬¡å›åº”æœåŠ¡æ®µä¸€ä¸ª ACK æŠ¥æ–‡ï¼Œè¿™æ˜¯æŠ¥æ–‡æ®µ 3ã€‚

> **ä¸ºäº†é˜²æ­¢ ACK æŠ¥æ–‡çš„ä¸¢å¤±ï¼Œä¸»åŠ¨å…³é—­è¿æ¥çš„é‚£ä¸€æ–¹åœ¨æŒ¥æ‰‹åä¼šè¿›å…¥ Time_Wait çŠ¶æ€ 2MSLï¼Œæ‰€ä»¥ä¼šæœ‰æŠ¥æ–‡æ®µ 3ã€‚**

## å››æ¬¡æŒ¥æ‰‹

1. TCP å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FINï¼Œç”¨æ¥å…³é—­å®¢æˆ·åˆ°æœåŠ¡å™¨çš„æ•°æ®ä¼ é€ï¼ˆæŠ¥æ–‡æ®µ 4ï¼‰ã€‚
2. æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ª FINï¼Œå®ƒå‘å›ä¸€ä¸ª ACKï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°çš„åºå·åŠ  1ï¼ˆæŠ¥æ–‡æ®µ 5ï¼‰ã€‚å’Œ SYN ä¸€æ ·ï¼Œä¸€ä¸ª FIN å°†å ç”¨ä¸€ä¸ªåºå·ã€‚
3. æœåŠ¡å™¨å…³é—­å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå‘é€ä¸€ä¸ª FIN ç»™å®¢æˆ·ç«¯ï¼ˆæŠ¥æ–‡æ®µ 6ï¼‰ã€‚
4. å®¢æˆ·æ®µå‘å› ACK æŠ¥æ–‡ç¡®è®¤ï¼Œå¹¶å°†ç¡®è®¤åºå·è®¾ç½®ä¸ºæ”¶åˆ°åºå·åŠ  1ï¼ˆæŠ¥æ–‡æ®µ 7ï¼‰

> **ç”±äº TCP è¿æ¥æ˜¯å…¨åŒå·¥çš„ï¼Œå› æ­¤æ¯ä¸ªæ–¹å‘éƒ½å¿…é¡»å•ç‹¬è¿›è¡Œå…³é—­ã€‚è¿™åŸåˆ™æ˜¯å½“ä¸€æ–¹å®Œæˆå®ƒçš„æ•°æ®å‘é€ä»»åŠ¡åå°±èƒ½å‘é€ä¸€ä¸ª FIN æ¥ç»ˆæ­¢è¿™ä¸ªæ–¹å‘çš„è¿æ¥ã€‚æ”¶åˆ°ä¸€ä¸ª FIN åªæ„å‘³ç€è¿™ä¸€æ–¹å‘ä¸Šæ²¡æœ‰æ•°æ®æµåŠ¨ï¼Œä¸€ä¸ª TCP è¿æ¥åœ¨æ”¶åˆ°ä¸€ä¸ª FIN åä»èƒ½å‘é€æ•°æ®ã€‚é¦–å…ˆè¿›è¡Œå…³é—­çš„ä¸€æ–¹å°†æ‰§è¡Œä¸»åŠ¨å…³é—­ï¼Œè€Œå¦ä¸€æ–¹æ‰§è¡Œè¢«åŠ¨å…³é—­ã€‚**

## æŠ¥æ–‡

### Request

```txt
GET https://www.baidu.com/ HTTP/1.1                 è¯·æ±‚è¡Œ
Host: www.baidu.com                                 è¯·æ±‚é¦–éƒ¨Start
Connection: keep-alive
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Cookie: BD_UPN=12314753; BAIDUID=E0F6577B684DB85DFCFA4261C4651DC7:FG=1; PSTM=1524902996; BIDUPSID=EADC64EBC64ADC032DD507CE9A3B015A; MCITY=-289%3A; ispeed_lsm=2; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; H_PS_PSSID=1439_26909_21113_26350_26920_22160; BD_CK_SAM=1; PSINO=5; H_PS_645EC=82b7hDUlpHfoKBJnLyG6t8vp5XqjkJBRaGfFLeAWDEASmhHmrTRTNo0LBeY; BDSVRTM=0                                                  è¯·æ±‚é¦–éƒ¨End
                                                    ç©ºè¡Œ(\r\n)
```

### Response

```txt
HTTP/1.1 200 OK                                     çŠ¶æ€è¡Œ
Bdpagetype: 1                                       å“åº”é¦–éƒ¨Start
Bdqid: 0xa931799600026945
Cache-Control: private
Connection: Keep-Alive
Content-Encoding: gzip
Content-Type: text/html
Cxy_all: baidu+ad08bc06781b921abb5a08650fbbcf58
Date: Fri, 27 Jul 2018 06:24:23 GMT
Expires: Fri, 27 Jul 2018 06:24:14 GMT
Server: BWS/1.1
Set-Cookie: BDSVRTM=0; path=/
Set-Cookie: BD_HOME=0; path=/
Set-Cookie: H_PS_PSSID=1439_26909_21113_26350_26920_22160; path=/; domain=.baidu.com
Strict-Transport-Security: max-age=172800
Vary: Accept-Encoding
X-Ua-Compatible: IE=Edge,chrome=1
Transfer-Encoding: chunked                          å“åº”é¦–éƒ¨End
                                                    ç©ºè¡Œ(\r\n)
ffa                                                 æŠ¥æ–‡ä¸»ä½“Start
        y $ u' 7` ï¬Z     B '  W7 h(-23 *   <    k (RÃ‘ 1 ht fe:fM iME f Q     |     = =<  qIC  ÎŒ ÛŸ   {   ^ z  7 

*** FIDDLER: RawDisplay truncated at 128 characters. Right-click to disable truncation. ***                               æŠ¥æ–‡ä¸»ä½“End
```

## åŠ¨è¯

- `GET` _è·å–èµ„æº_
- `POST` _ä¼ è¾“å®ä½“ä¸»ä½“_
- `PUT` _ä¼ è¾“æ–‡ä»¶_
- `HEAD` _è·å¾—æŠ¥æ–‡é¦–éƒ¨_
- `DELETE` _åˆ é™¤æ–‡ä»¶_
- `OPTIONS` _è®¿é—®æ”¯æŒæ–¹æ³•_
- `TRACE` _è¿½è¸ªè·¯å¾„_
- `CONNECT` _è¦æ±‚ç”¨éš§é“åè®®è¿æ¥ä»£ç†_

## HTTP çŠ¶æ€ç ([è¯¦ç»†](http://tool.oschina.net/commons?type=5))

- `203` _éæˆæƒä¿¡æ¯_
- `301` _æ°¸ä¹…é‡å®šå‘_
- `302` _æš‚æ—¶é‡å®šå‘_
- `307` _æš‚æ—¶é‡å®šå‘_
- `401` _æœªæˆæƒ_
- `408` _è¯·æ±‚è¶…æ—¶_
- `502` _é”™è¯¯ç½‘å…³_
- `504` _ç½‘å…³è¶…æ—¶_

## HTTPç‰ˆæœ¬å·®å¼‚[æº](https://www.cnbeta.com/articles/tech/835745.htm)

| HTTP ç‰ˆæœ¬|ç‰¹ç‚¹| ç¼ºç‚¹|
| :--- | :--- | :--- |
| HTTP/0.9 | æ”¯æŒ Get è¯·æ±‚ï¼Œä¸æ”¯æŒè¯·æ±‚å¤´|
| HTTP/1.0  | æ”¯æŒ POSTã€HEAD è¯·æ±‚| è¿æ¥æ— æ³•å¤ç”¨(æ¯æ¬¡éƒ½éœ€è¦é‡æ–°å»ºç«‹è¿æ¥)ï¼Œé˜Ÿå¤´é˜»å¡(ä¸‹ä¸ªè¯·æ±‚å¿…é¡»åœ¨å‰ä¸€ä¸ªè¯·æ±‚è¿”å›åæ‰èƒ½å‘å‡º)ï¼Œåè®®å¼€é”€å¤§ï¼Œå®‰å…¨å› ç´ |
| HTTP/1.1  | Keep-Aliveï¼Œpipeling | è¿æ¥æ— æ³•å¤ç”¨(åŸŸååˆ†ç‰‡æ—¶ä»éœ€è¦å»ºç«‹å¤šä¸ªè¿æ¥)ï¼Œé˜Ÿå¤´é˜»å¡(åé¢çš„è¯·æ±‚è¦ç­‰åˆ°å‰ä¸€ä¸ªè¯·æ±‚å¤„ç†å®Œæ‰æŒ‰åºè¿”å›)ï¼Œåè®®å¼€é”€å¤§ï¼Œå®‰å…¨å› ç´  |
| HTTP/2| åŸºäº SPDY3ï¼ŒäºŒè¿›åˆ¶ä¼ è¾“æ•°æ®ï¼Œå¤šè·¯å¤ç”¨ï¼Œheader å‹ç¼©ï¼ŒæœåŠ¡ç«¯é¢„æ¨é€ | å¦‚æœä¸¢åŒ…éœ€è¦é‡ä¼ æ•ˆç‡å¯èƒ½ä¸å¦‚ HTTP1.1 |
| HTTP/3| åŸºäº QUIC(UDP)ï¼ŒåŸç”Ÿå®ç°å¤šè·¯å¤ç”¨ï¼ŒåŠ å¯†è®¤è¯çš„æŠ¥æ–‡ï¼Œå‰å‘çº é”™(ä¸¢ä¸€ä¸ªåŒ…æ—¶å¯é€šè¿‡å…¶ä»–åŒ…è®¡ç®—å‡ºæ¥) | ä¸¢å¤±å¤šä¸ªåŒ…æ—¶ä»éœ€é‡ä¼ |

> HTTP/1 æœ‰è¿æ¥æ— æ³•å¤ç”¨ã€é˜Ÿå¤´é˜»å¡ã€åè®®å¼€é”€å¤§å’Œå®‰å…¨å› ç´ ç­‰å¤šä¸ªç¼ºé™·

> HTTP/2 é€šè¿‡å¤šè·¯å¤ç”¨ã€äºŒè¿›åˆ¶æµä¸ Header å‹ç¼©ç­‰æŠ€æœ¯ï¼Œæå¤§åœ°æé«˜äº†æ€§èƒ½ï¼Œä½†æ˜¯è¿˜æ˜¯å­˜åœ¨ä¸€äº›é—®é¢˜

> HTTP/3 æŠ›å¼ƒ TCP åè®®ï¼Œä»¥å…¨æ–°çš„è§†è§’é‡æ–°è®¾è®¡ HTTPã€‚å…¶åº•å±‚æ”¯æ’‘æ˜¯ QUIC åè®®ï¼Œè¯¥åè®®åŸºäº UDPï¼Œæœ‰ UDP ç‰¹æœ‰çš„ä¼˜åŠ¿ï¼ŒåŒæ—¶å®ƒåˆå–äº† TCP ä¸­çš„ç²¾åï¼Œå®ç°äº†å³å¿«åˆå¯é çš„åè®®

## HTTPS[æº](https://www.cnblogs.com/mddblog/p/6948980.html)

- [HTTPS äº¤äº’æµç¨‹](http://7xs4tc.com1.z0.glb.clouddn.com/httpsCreat.png)

## REST API

| æ–¹æ³•|æè¿°|å¹‚ç­‰|
| :--- | :--- | :--- |
| GET | æŸ¥è¯¢æ“ä½œ | <input type="checkbox" checked /> |
| POST | æ–°å¢æ“ä½œ | <input type="checkbox" /> |
| PUT | æ•´ä½“æ›´æ–° | <input type="checkbox" checked /> |
| PATCH | éƒ¨åˆ†æ›´æ–° | <input type="checkbox" /> |
| DELETE | åˆ é™¤æ“ä½œ | <input type="checkbox" checked /> |
| HEAD | è·å–å…ƒæ•°æ®ï¼Œæˆ–æ£€æŸ¥APIæ˜¯å¦å¥åº· | <input type="checkbox" checked /> |
| OPTIONS | è·å–APIç›¸å…³ä¿¡æ¯ | <input type="checkbox" checked /> |
